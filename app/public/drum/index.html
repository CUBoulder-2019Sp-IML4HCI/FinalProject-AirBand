<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Drum</title>
    <link href="../libraries/foundation/css/foundation.min.css" rel="stylesheet"></link>
    <link href="http://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css" rel="stylesheet">

    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="../libraries/foundation/js/vendor/foundation.min.js" type="text/javascript"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="../libraries/Tone.js"></script>
    <script src="../eventDispatcher.js" type="text/javascript"></script>
    <script src="../libraries/webcam.min.js"></script>

    <style> 
      body {padding: 0; margin: 0;} 
    </style>
  </head>
  <body class="body-container">
    <h1>Test Drum App</h1>
    <div><span>Current Drum Class:&nbsp;&nbsp;</span><span id="currentEvent">None</span></div>
    <form>
      <input id="startRec" type="button" class="btn js-startRec" value="Start Rec">
      <input id="stopRec" type="button" class="btn js-stopRec" value="Stop Rec">
      <input id="clear" type="button" class="btn js-clear" value="Clear">
      <input id="train" type="button" class="btn js-train" value="Train">
      <input id="run" type="button" class="btn js-run" value="Run">
    </form>



    <!-- <div class="left">
    <h1>WebcamJS Test Page</h1>
    <h3>Demonstrates continuous capture &amp; display</h3>
    
    <div id="my_camera"></div> -->
    
    <!-- A button for taking snaps -->
    <!-- <form>
      <input type="button" value="Start" onClick="start_snapping()">
      <input type="button" value="Stop" onClick="stop_snapping()">
      <input type="button" value="Clear" onClick="erase_snaps()">
    </form> -->
  </div>
  </body>
  <!-- Configure a few settings and attach camera -->
  <!--<script language="JavaScript">
    Webcam.set({
      width: 320,
      height: 240,
      image_format: 'jpeg',
      jpeg_quality: 90,
      flip_horiz: true
    });
    Webcam.attach( '#my_camera' );
  </script>
  
  <!-- Code to handle taking the snapshot and displaying it locally 
  <script language="JavaScript">
    var timer = null;

    //**dataURL to blob**
    function dataURLtoBlob(dataurl) {
      var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
          bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
      while(n--){
          u8arr[n] = bstr.charCodeAt(n);
      }
      return new Blob([u8arr], {type:mime});
    }
    
    function take_snapshot() {
      // take snapshot and get image data
      Webcam.snap( function(data_uri) {
        // display results in page
        var img = new Image();
        img.src = data_uri;
        
        console.log(dataURLtoBlob(data_uri));
      } );
    }
    
    function start_snapping() {
      if (!timer) {
        take_snapshot();
        timer = setInterval( take_snapshot, 250 );
      }
    }
    
    function stop_snapping() {
      if (timer) {
        clearTimeout( timer );
        timer = null;
      }
    }
    
    function erase_snaps() {
      document.getElementById('results').innerHTML = '';
    }
  </script> -->
  <script src="drumModel.js" type="text/javascript"></script>
  <script src="drumView.js" type="text/javascript"></script>
  <script src="drumController.js" type="text/javascript"></script>
  <script>
    var touched = false;
    function mousePressed() { if (!touched) {
     getAudioContext().resume(); touched = true} 
    }
    var model = new DrumModel(),
        view = new DrumView(model),
        controller = new DrumController(model, view);

  </script>
  <script>
    $(document).foundation();
  </script>
</html>
